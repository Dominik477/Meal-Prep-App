CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    email VARCHAR(255) UNIQUE NOT NULL,
    full_name VARCHAR(255) NOT NULL
);

CREATE TABLE products (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    calories_per_100g INTEGER NOT NULL
);

CREATE TABLE meals (
    id SERIAL PRIMARY KEY,
    user_id INTEGER NOT NULL REFERENCES users(id) ON DELETE CASCADE,
    name VARCHAR(255) NOT NULL
);

CREATE TABLE meal_products (
    meal_id INTEGER NOT NULL REFERENCES meals(id) ON DELETE CASCADE,
    product_id INTEGER NOT NULL REFERENCES products(id) ON DELETE RESTRICT,
    quantity_grams INTEGER NOT NULL CHECK (quantity_grams > 0),
    PRIMARY KEY (meal_id, product_id)
);

INSERT INTO users (email, full_name) VALUES
('anna@example.com', 'Anna Kowalska'),
('piotr@example.com', 'Piotr Nowak'),
('dominik@example.com', 'Dominik Test');

INSERT INTO products (name, calories_per_100g) VALUES
('Ryż biały', 360),
('Pierś z kurczaka', 165),
('Brokuł', 35);

INSERT INTO meals (user_id, name) VALUES
(1, 'Kurczak z ryżem i brokułem'),
(1, 'Ryż z warzywami'),
(2, 'Kurczak z brokułem');

d, product_id, quantity_grams) VALUES
(1, 1, 100), 
(1, 2, 150), 
(1, 3, 80);   


INSERT INTO meal_products (meal_id, product_id, quantity_grams) VALUES
(2, 1, 120),
(2, 3, 100);


INSERT INTO meal_products (meal_id, product_id, quantity_grams) VALUES
(3, 2, 200),
(3, 3, 90);
